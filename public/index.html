<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>WorldChat</title>
<style>
  /* Reset b√°sico */
  * {
    box-sizing: border-box;
  }
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
      Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    background: #e6f0ff; /* azul clarinho suave */
    color: #1c1c1e; /* cinza escuro */
    margin: 0;
    padding: 0 15px 30px 15px;
    min-height: 100vh;
  }
  header {
    text-align: center;
    padding: 25px 0 15px;
    font-size: 2.4em;
    font-weight: 600;
    color: #0a47a1; /* azul iOS */
    position: relative;
  }

  /* Idioma dentro do modal (fonte menor) */
  #languageSelectModal {
    font-size: 0.9em;
    padding: 6px 10px;
    border-radius: 14px;
    border: 1.5px solid #cbd2d9;
    outline-offset: 2px;
    outline-color: #0a84ff;
    cursor: pointer;
    background: white;
    margin-top: 10px;
    display: block;
    width: 100%;
  }

  /* Idioma fixo discreto no canto superior direito ap√≥s aceitar */
  #languageSelectFixed {
    position: fixed;
    top: 10px;
    right: 15px;
    font-size: 0.8em;
    padding: 4px 8px;
    border-radius: 14px;
    border: 1.2px solid #cbd2d9;
    background: white;
    cursor: pointer;
    box-shadow: 0 1px 6px rgba(0,0,0,0.1);
    display: none;
    align-items: center;
    gap: 6px;
    font-weight: 600;
  }
  #languageSelectFixed span {
    font-size: 1.15em;
  }

  /* Modal do aviso */
  .modal {
    position: fixed;
    z-index: 1000;
    left: 0; top: 0; width: 100%; height: 100%;
    background-color: rgba(0,0,0,0.5);
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .modal-content {
    background: white;
    max-width: 450px;
    padding: 25px 30px 30px;
    border-radius: 20px;
    box-shadow: 0 8px 24px rgba(10,10,10,0.15);
    text-align: center;
    font-size: 1.05em;
    line-height: 1.5em;
    color: #1c1c1e;
  }
  .modal-content h2 {
    margin-top: 0;
    font-weight: 700;
    color: #c0392b;
  }
  .modal-content ul {
    text-align: left;
    margin-left: 25px;
    margin-bottom: 20px;
  }
  .modal-content ul li {
    margin-bottom: 8px;
  }
  #btnAceitar {
    background-color: #0a84ff;
    color: white;
    border: none;
    padding: 14px 25px;
    border-radius: 14px;
    font-size: 1.1em;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(10,132,255,0.4);
    transition: background-color 0.3s ease;
    margin-top: 15px;
  }
  #btnAceitar:hover {
    background-color: #0063d1;
  }

  /* Main */
  #main {
    max-width: 480px;
    margin: 20px auto 0;
    background: white;
    border-radius: 22px;
    padding: 25px 30px 30px;
    box-shadow: 0 6px 18px rgba(10,10,10,0.1);
  }

  h2 {
    font-weight: 700;
    margin-bottom: 15px;
    color: #0a47a1;
  }

  input, select {
    width: 100%;
    font-size: 1.1em;
    padding: 12px 14px;
    border-radius: 14px;
    border: 1.8px solid #cbd2d9;
    margin-bottom: 18px;
    outline-offset: 2px;
    outline-color: #0a84ff;
    font-family: inherit;
  }
  input:focus, select:focus {
    border-color: #0a84ff;
  }

  #errorNickname {
    color: #e74c3c;
    font-size: 0.9em;
    margin-top: -14px;
    margin-bottom: 18px;
  }

  /* Lista de salas */
  .room-list {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    justify-content: center;
  }
  .room {
    background: white;
    border-radius: 16px;
    width: calc(50% - 12px);
    min-width: 140px;
    box-shadow: 0 4px 12px rgba(10,10,10,0.07);
    cursor: pointer;
    padding: 14px 12px;
    display: flex;
    align-items: center;
    gap: 12px;
    transition: box-shadow 0.3s ease;
  }
  .room:hover {
    box-shadow: 0 6px 20px rgba(10,132,255,0.3);
  }
  .room img {
    width: 40px;
    height: 28px;
    border-radius: 5px;
    object-fit: cover;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
  .room > div {
    font-weight: 600;
    font-size: 1.1em;
    color: #0a47a1;
    flex-grow: 1;
  }
  .count {
    background: #0a84ff;
    color: white;
    font-weight: 700;
    padding: 6px 12px;
    border-radius: 14px;
    font-size: 0.95em;
    user-select: none;
  }

  @media (max-width: 480px) {
    .room {
      width: 100%;
    }
  }
</style>
</head>
<body>

<header>
  WorldChat
</header>

<!-- Modal do aviso -->
<div id="modalAviso" class="modal">
  <div class="modal-content">
    <h2 id="avisoTitle">‚ö†Ô∏è Aviso Importante ‚Äî Uso Restrito a Maiores de 18 Anos ‚ö†Ô∏è</h2>
    <p id="avisoText1">Este site √© destinado exclusivamente a pessoas com 18 anos ou mais. Ao acessar, voc√™ declara que possui idade m√≠nima exigida e que est√° ciente de que:</p>
    <ul id="avisoList">
      <li>N√£o nos responsabilizamos pelo conte√∫do das mensagens.</li>
      <li>√â proibido conte√∫do ofensivo, pornogr√°fico, discriminat√≥rio ou ilegal.</li>
      <li>O n√£o cumprimento resultar√° em banimento imediato.</li>
    </ul>

    <label for="languageSelectModal" style="font-weight:600; display:block; margin-bottom:6px;">Escolha o idioma / Choose Language / –í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫ / ‡§≠‡§æ‡§∑‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç / ÿßÿÆÿ™ÿ± ÿßŸÑŸÑÿ∫ÿ©</label>
    <select id="languageSelectModal" aria-label="Selecione o idioma do site">
      <option value="pt">Portugu√™s (BR)</option>
      <option value="en">English</option>
      <option value="ru">–†—É—Å—Å–∫–∏–π</option>
      <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
      <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
    </select>

    <button id="btnAceitar">EU ACEITO</button>
  </div>
</div>

<div id="main" style="display:none;">
    <h2 id="tituloNickname">Escolha seu Nickname e Idade</h2>
    <input id="nickname" placeholder="Nickname" />
    <div id="errorNickname"></div>
	
<input 
  type="number" 
  id="idade" 
  name="idade" 
  min="18" 
  max="120"
  placeholder="18" 
  autocomplete="off" 
  inputmode="numeric"
/>

<script>
(function () {
  const idadeInput = document.getElementById('idade');

  // estado para distinguir typing vs spinner
  let prevValue = idadeInput.value; // inicialmente ""
  let lastKeydownTs = 0;

  // registra keydowns (typing). Usado para n√£o confundir digita√ß√£o com spinner/mouse.
  idadeInput.addEventListener('keydown', (e) => {
    lastKeydownTs = Date.now();

    // se usu√°rio pressionar seta pra cima quando estiver vazio, iniciamos em 18
    if ((e.key === 'ArrowUp' || e.key === 'ArrowDown') && idadeInput.value === '') {
      e.preventDefault(); // evita comportamento padr√£o inconsistente
      idadeInput.value = '18';
      prevValue = idadeInput.value;
    }
  });

  // input: permite apagar; detecta mudan√ßa quando prevValue == '' (poss√≠vel spinner / paste)
  idadeInput.addEventListener('input', (e) => {
    const valStr = idadeInput.value;

    // se ficou vazio, apenas atualiza estado e sai (permite apagar)
    if (valStr === '') {
      prevValue = '';
      return;
    }

    // Se antes estava vazio e agora n√£o: pode ser spinner (mouse) ou usu√°rio digitando '1' rapidamente.
    // Para n√£o atrapalhar a digita√ß√£o, s√≥ tratamos como "spinner" se N√ÉO houve keydown recente.
    const sinceKey = Date.now() - lastKeydownTs;

    // threshold em ms ‚Äî se n√£o houve keydown nos √∫ltimos 180ms, assumimos a√ß√£o via spinner / clique.
    if (!prevValue && valStr !== '' && sinceKey > 180) {
      // Iniciar em 18 conforme solicitado
      idadeInput.value = '18';
      prevValue = idadeInput.value;
      return;
    }

    // caso contr√°rio, o usu√°rio est√° digitando com teclado: apenas atualizamos prevValue
    prevValue = valStr;
  });

  // Ao sair do campo, valida o n√∫mero (se houver)
  idadeInput.addEventListener('blur', () => {
    const v = String(idadeInput.value).trim();
    if (v === '') {
      // campo vazio fica vazio
      prevValue = '';
      return;
    }

    const n = parseInt(v, 10);
    if (isNaN(n) || n < 18 || n > 120) {
      idadeInput.value = '18';
      prevValue = '18';
    } else {
      // normaliza (remove zeros √† esquerda, etc)
      idadeInput.value = String(n);
      prevValue = String(n);
    }
  });

  // Tamb√©m valide no evento "change" (alguns navegadores disparam change ao usar spinner)
  idadeInput.addEventListener('change', () => {
    const v = String(idadeInput.value).trim();
    if (v === '') {
      prevValue = '';
      return;
    }
    const n = parseInt(v, 10);
    if (isNaN(n) || n < 18 || n > 120) {
      idadeInput.value = '18';
      prevValue = '18';
    } else {
      idadeInput.value = String(n);
      prevValue = String(n);
    }
  });
})();
</script>




    <h2 id="tituloSala">Escolha uma sala</h2>
    <div class="room-list" id="roomList">
      <div class="room" onclick="entrarSala('Ingl√™s')">
        <img src="https://flagcdn.com/us.svg" alt="Ingl√™s" />
        <div id="labelIngles">Ingl√™s (EUA)</div>
        <div class="count" id="count-Ingl√™s">0</div>
      </div>
      <div class="room" onclick="entrarSala('Mandarim')">
        <img src="https://flagcdn.com/cn.svg" alt="Mandarim" />
        <div id="labelMandarim">Mandarim (China)</div>
        <div class="count" id="count-Mandarim">0</div>
      </div>
      <div class="room" onclick="entrarSala('Espanhol')">
        <img src="https://flagcdn.com/es.svg" alt="Espanhol" />
        <div id="labelEspanhol">Espanhol (Espanha)</div>
        <div class="count" id="count-Espanhol">0</div>
      </div>
      <div class="room" onclick="entrarSala('Hindi')">
        <img src="https://flagcdn.com/in.svg" alt="Hindi" />
        <div id="labelHindi">Hindi (√çndia)</div>
        <div class="count" id="count-Hindi">0</div>
      </div>
      <div class="room" onclick="entrarSala('√Årabe')">
        <img src="https://flagcdn.com/sa.svg" alt="√Årabe" />
        <div id="labelArabe">√Årabe (Ar√°bia Saudita)</div>
        <div class="count" id="count-√Årabe">0</div>
      </div>
      <div class="room" onclick="entrarSala('Franc√™s')">
        <img src="https://flagcdn.com/fr.svg" alt="Franc√™s" />
        <div id="labelFrances">Franc√™s (Fran√ßa)</div>
        <div class="count" id="count-Franc√™s">0</div>
      </div>
      <div class="room" onclick="entrarSala('Russo')">
        <img src="https://flagcdn.com/ru.svg" alt="Russo" />
        <div id="labelRusso">Russo (R√∫ssia)</div>
        <div class="count" id="count-Russo">0</div>
      </div>
      <div class="room" onclick="entrarSala('Portugu√™s')">
        <img src="https://flagcdn.com/br.svg" alt="Portugu√™s" />
        <div id="labelPortugues">Portugu√™s (Brasil)</div>
        <div class="count" id="count-Portugu√™s">0</div>
      </div>
      <div class="room" onclick="entrarSala('Bengali')">
        <img src="https://flagcdn.com/bd.svg" alt="Bengali" />
        <div id="labelBengali">Bengali (Bangladesh)</div>
        <div class="count" id="count-Bengali">0</div>
      </div>
      <div class="room" onclick="entrarSala('Japon√™s')">
        <img src="https://flagcdn.com/jp.svg" alt="Japon√™s" />
        <div id="labelJapones">Japon√™s (Jap√£o)</div>
        <div class="count" id="count-Japon√™s">0</div>
      </div>
      <div class="room" onclick="entrarSala('Lahnda')">
        <img src="https://flagcdn.com/pk.svg" alt="Lahnda" />
        <div id="labelLahnda">Lahnda (Paquist√£o)</div>
        <div class="count" id="count-Lahnda">0</div>
      </div>
      <div class="room" onclick="entrarSala('Javan√™s')">
        <img src="https://flagcdn.com/id.svg" alt="Javan√™s" />
        <div id="labelJavanes">Javan√™s (Indon√©sia)</div>
        <div class="count" id="count-Javan√™s">0</div>
      </div>
	    <div class="room" onclick="entrarSala('Italiano')">
        <img src="https://flagcdn.com/it.svg" alt="Javan√™s" />
        <div id="labelItaliano">Italiano (It√°lia)</div>
        <div class="count" id="count-Javan√™s">0</div>
      </div>
      <div class="room" onclick="entrarSala('Turco')">
        <img src="https://flagcdn.com/tr.svg" alt="Turco" />
        <div id="labelTurco">Turco (Turquia)</div>
        <div class="count" id="count-Turco">0</div>
      </div>
    </div>
</div>

<!-- Idioma fixo discreto ap√≥s aceitar -->
<div id="languageSelectFixed">
  <span>üåê</span>
  <select id="languageSelectFixedSelect" aria-label="Alterar idioma do site">
    <option value="pt">Portugu√™s (BR)</option>
    <option value="en">English</option>
    <option value="ru">–†—É—Å—Å–∫–∏–π</option>
    <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
    <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
  </select>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
  const modal = document.getElementById('modalAviso');
  const btnAceitar = document.getElementById('btnAceitar');
  const mainDiv = document.getElementById('main');

  const languageSelectModal = document.getElementById('languageSelectModal');
  const languageSelectFixed = document.getElementById('languageSelectFixed');
  const languageSelectFixedSelect = document.getElementById('languageSelectFixedSelect');
  
  // -- AJUSTE INICIAL PARA EVITAR FLASH --
  modal.style.display = 'flex';
  mainDiv.style.display = 'none';
  languageSelectFixed.style.display = 'none';

  const nicknameInput = document.getElementById('nickname');
  const errorNickname = document.getElementById('errorNickname');

  // Textos para os idiomas (mesmo do exemplo anterior, omitidos aqui para economizar espa√ßo)
  const texts = {
    pt: {
      header: 'WorldChat',
      avisoTitle: '‚ö†Ô∏è Aviso Importante ‚Äî Uso Restrito a Maiores de 18 Anos ‚ö†Ô∏è',
      avisoText1: 'Este site √© destinado exclusivamente a pessoas com 18 anos ou mais. Ao acessar, voc√™ declara que possui idade m√≠nima exigida e que est√° ciente de que:',
      avisoList: [
        'N√£o nos responsabilizamos pelo conte√∫do das mensagens.',
        '√â proibido conte√∫do ofensivo, pornogr√°fico, discriminat√≥rio ou ilegal.',
        'O n√£o cumprimento resultar√° em banimento imediato.'
      ],
      btnAceitar: 'EU ACEITO',
      tituloNickname: 'Escolha seu Nickname e Idade',
      placeholderNickname: 'Nickname',
      placeholderIdade: 'Idade',
      tituloSala: 'Escolha uma sala',
      salas: {
        Ingl√™s: 'Ingl√™s (EUA)',
        Mandarim: 'Mandarim (China)',
        Espanhol: 'Espanhol (Espanha)',
        Hindi: 'Hindi (√çndia)',
        √Årabe: '√Årabe (Ar√°bia Saudita)',
        Franc√™s: 'Franc√™s (Fran√ßa)',
        Russo: 'Russo (R√∫ssia)',
        Portugu√™s: 'Portugu√™s (Brasil)',
        Bengali: 'Bengali (Bangladesh)',
        Japon√™s: 'Japon√™s (Jap√£o)',
        Lahnda: 'Lahnda (Paquist√£o)',
        Javan√™s: 'Javan√™s (Indon√©sia)',
        Turco: 'Turco (Turquia)'
      },
      erroNicknameObrigatorio: 'O nickname √© obrigat√≥rio.',
      erroNicknameTamanho: 'O nickname deve ter no m√°ximo 20 caracteres.',
      erroNicknameEspaco: 'O nickname n√£o pode conter espa√ßos.',
      erroNicknameEspecial: 'O nickname n√£o pode conter caracteres especiais.',
      erroIdadeObrigatoria: 'Preencha a idade.'
    },
    en: {
      header: 'WorldChat',
      avisoTitle: '‚ö†Ô∏è Important Notice ‚Äî 18+ Only ‚ö†Ô∏è',
      avisoText1: 'This site is for people aged 18 and over only. By accessing, you declare you meet the minimum age requirement and understand that:',
      avisoList: [
        'We are not responsible for the content of messages.',
        'Offensive, pornographic, discriminatory or illegal content is prohibited.',
        'Failure to comply will result in immediate ban.'
      ],
      btnAceitar: 'I ACCEPT',
      tituloNickname: 'Choose your Nickname and Age',
      placeholderNickname: 'Nickname',
      placeholderIdade: 'Age',
      tituloSala: 'Choose a room',
      salas: {
        Ingl√™s: 'English (USA)',
        Mandarim: 'Mandarin (China)',
        Espanhol: 'Spanish (Spain)',
        Hindi: 'Hindi (India)',
        √Årabe: 'Arabic (Saudi Arabia)',
        Franc√™s: 'French (France)',
        Russo: 'Russian (Russia)',
        Portugu√™s: 'Portuguese (Brazil)',
        Bengali: 'Bengali (Bangladesh)',
        Japon√™s: 'Japanese (Japan)',
        Lahnda: 'Lahnda (Pakistan)',
        Javan√™s: 'Javanese (Indonesia)',
        Turco: 'Turkish (Turkey)'
      },
      erroNicknameObrigatorio: 'Nickname is required.',
      erroNicknameTamanho: 'Nickname must be 20 characters or less.',
      erroNicknameEspaco: 'Nickname cannot contain spaces.',
      erroNicknameEspecial: 'Nickname cannot contain special characters.',
      erroIdadeObrigatoria: 'Please enter your age.'
    },
   ru: {
    header: 'WorldChat',
    avisoTitle: '‚ö†Ô∏è –í–∞–∂–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è –ª–∏—Ü —Å—Ç–∞—Ä—à–µ 18 –ª–µ—Ç ‚ö†Ô∏è',
    avisoText1: '–≠—Ç–æ—Ç —Å–∞–π—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –ª–∏—Ü –æ—Ç 18 –ª–µ—Ç –∏ —Å—Ç–∞—Ä—à–µ. –ü–æ–ª—É—á–∞—è –¥–æ—Å—Ç—É–ø, –≤—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç–µ, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º—É –≤–æ–∑—Ä–∞—Å—Ç—É –∏ –ø–æ–Ω–∏–º–∞–µ—Ç–µ, —á—Ç–æ:',
    avisoList: [
      '–ú—ã –Ω–µ –Ω–µ—Å–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π.',
      '–ó–∞–ø—Ä–µ—â–µ–Ω –æ—Å–∫–æ—Ä–±–∏—Ç–µ–ª—å–Ω—ã–π, –ø–æ—Ä–Ω–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π, –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏–æ–Ω–Ω—ã–π –∏–ª–∏ –Ω–µ–∑–∞–∫–æ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç.',
      '–ù–µ—Å–æ–±–ª—é–¥–µ–Ω–∏–µ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–º—É –±–∞–Ω—É.'
    ],
    btnAceitar: '–ü–†–ò–ù–Ø–¢–¨',
    tituloNickname: '–í—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ–π –Ω–∏–∫–Ω–µ–π–º –∏ –≤–æ–∑—Ä–∞—Å—Ç',
    placeholderNickname: '–ù–∏–∫–Ω–µ–π–º',
    placeholderIdade: '–í–æ–∑—Ä–∞—Å—Ç',
    tituloSala: '–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–Ω–∞—Ç—É',
    salas: {
      Ingl√™s: '–ê–Ω–≥–ª–∏–π—Å–∫–∏–π (–°–®–ê)',
      Mandarim: '–ú–∞–Ω–¥–∞—Ä–∏–Ω—Å–∫–∏–π (–ö–∏—Ç–∞–π)',
      Espanhol: '–ò—Å–ø–∞–Ω—Å–∫–∏–π (–ò—Å–ø–∞–Ω–∏—è)',
      Hindi: '–•–∏–Ω–¥–∏ (–ò–Ω–¥–∏—è)',
      √Årabe: '–ê—Ä–∞–±—Å–∫–∏–π (–°–∞—É–¥–æ–≤—Å–∫–∞—è –ê—Ä–∞–≤–∏—è)',
      Franc√™s: '–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π (–§—Ä–∞–Ω—Ü–∏—è)',
      Russo: '–†—É—Å—Å–∫–∏–π (–†–æ—Å—Å–∏—è)',
      Portugu√™s: '–ü–æ—Ä—Ç—É–≥–∞–ª—å—Å–∫–∏–π (–ë—Ä–∞–∑–∏–ª–∏—è)',
      Bengali: '–ë–µ–Ω–≥–∞–ª—å—Å–∫–∏–π (–ë–∞–Ω–≥–ª–∞–¥–µ—à)',
      Japon√™s: '–Ø–ø–æ–Ω—Å–∫–∏–π (–Ø–ø–æ–Ω–∏—è)',
      Lahnda: '–õ–∞—Ö–Ω–¥–∞ (–ü–∞–∫–∏—Å—Ç–∞–Ω)',
      Javan√™s: '–Ø–≤–∞–Ω—Å–∫–∏–π (–ò–Ω–¥–æ–Ω–µ–∑–∏—è)',
      Turco: '–¢—É—Ä–µ—Ü–∫–∏–π (–¢—É—Ä—Ü–∏—è)'
    },
    erroNicknameObrigatorio: '–¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∏–∫–Ω–µ–π–º.',
    erroNicknameTamanho: '–ù–∏–∫–Ω–µ–π–º –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ –±–æ–ª–µ–µ 20 —Å–∏–º–≤–æ–ª–æ–≤.',
    erroNicknameEspaco: '–ù–∏–∫–Ω–µ–π–º –Ω–µ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–±–µ–ª—ã.',
    erroNicknameEspecial: '–ù–∏–∫–Ω–µ–π–º –Ω–µ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã.',
    erroIdadeObrigatoria: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à –≤–æ–∑—Ä–∞—Å—Ç.'
  },
  hi: {
    header: 'WorldChat',
    avisoTitle: '‚ö†Ô∏è ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§∏‡•Ç‡§ö‡§®‡§æ ‚Äî ‡§ï‡•á‡§µ‡§≤ 18+ ‡§ï‡•á ‡§≤‡§ø‡§è ‚ö†Ô∏è',
    avisoText1: '‡§Ø‡§π ‡§∏‡§æ‡§á‡§ü ‡§ï‡•á‡§µ‡§≤ 18 ‡§µ‡§∞‡•ç‡§∑ ‡§î‡§∞ ‡§â‡§∏‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§â‡§Æ‡•ç‡§∞ ‡§ï‡•á ‡§≤‡•ã‡§ó‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡•à‡•§ ‡§™‡•ç‡§∞‡§µ‡•á‡§∂ ‡§ï‡§∞‡§ï‡•á, ‡§Ü‡§™ ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§Ü‡§™‡§ï‡•Ä ‡§®‡•ç‡§Ø‡•Ç‡§®‡§§‡§Æ ‡§Ü‡§Ø‡•Å ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§∏‡§Æ‡§ù‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø:',
    avisoList: [
      '‡§π‡§Æ ‡§∏‡§Ç‡§¶‡•á‡§∂‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡§Ç‡•§',
      '‡§Ö‡§™‡§Æ‡§æ‡§®‡§ú‡§®‡§ï, ‡§Ö‡§∂‡•ç‡§≤‡•Ä‡§≤, ‡§≠‡•á‡§¶‡§≠‡§æ‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§Ø‡§æ ‡§Ö‡§µ‡•à‡§ß ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§®‡§ø‡§∑‡§ø‡§¶‡•ç‡§ß ‡§π‡•à‡•§',
      '‡§™‡§æ‡§≤‡§® ‡§® ‡§ï‡§∞‡§®‡•á ‡§™‡§∞ ‡§§‡§§‡•ç‡§ï‡§æ‡§≤ ‡§™‡•ç‡§∞‡§§‡§ø‡§¨‡§Ç‡§ß ‡§≤‡§ó ‡§ú‡§æ‡§è‡§ó‡§æ‡•§'
    ],
    btnAceitar: '‡§Æ‡•à‡§Ç ‡§∏‡§π‡§Æ‡§§ ‡§π‡•Ç‡§Å',
    tituloNickname: '‡§Ö‡§™‡§®‡§æ ‡§â‡§™‡§®‡§æ‡§Æ ‡§î‡§∞ ‡§â‡§Æ‡•ç‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç',
    placeholderNickname: '‡§â‡§™‡§®‡§æ‡§Æ',
    placeholderIdade: '‡§â‡§Æ‡•ç‡§∞',
    tituloSala: '‡§è‡§ï ‡§ï‡§ï‡•ç‡§∑ ‡§ö‡•Å‡§®‡•á‡§Ç',
    salas: {
      Ingl√™s: '‡§Ö‡§Ç‡§ó‡•ç‡§∞‡•á‡§ú‡§º‡•Ä (‡§Ø‡•Ç‡§è‡§∏‡§è)',
      Mandarim: '‡§Æ‡§Ç‡§¶‡§æ‡§∞‡§ø‡§® (‡§ö‡•Ä‡§®)',
      Espanhol: '‡§∏‡•ç‡§™‡•á‡§®‡§ø‡§∂ (‡§∏‡•ç‡§™‡•á‡§®)',
      Hindi: '‡§π‡§ø‡§Ç‡§¶‡•Ä (‡§≠‡§æ‡§∞‡§§)',
      √Årabe: '‡§Ö‡§∞‡§¨‡•Ä (‡§∏‡§ä‡§¶‡•Ä ‡§Ö‡§∞‡§¨)',
      Franc√™s: '‡§´‡•ç‡§∞‡•á‡§Ç‡§ö (‡§´‡•ç‡§∞‡§æ‡§Ç‡§∏)',
      Russo: '‡§∞‡•Ç‡§∏‡•Ä (‡§∞‡•Ç‡§∏)',
      Portugu√™s: '‡§™‡•Å‡§∞‡•ç‡§§‡§ó‡§æ‡§≤‡•Ä (‡§¨‡•ç‡§∞‡§æ‡§ú‡•Ä‡§≤)',
      Bengali: '‡§¨‡§Ç‡§ó‡§æ‡§≤‡•Ä (‡§¨‡§æ‡§Ç‡§ó‡•ç‡§≤‡§æ‡§¶‡•á‡§∂)',
      Japon√™s: '‡§ú‡§æ‡§™‡§æ‡§®‡•Ä (‡§ú‡§æ‡§™‡§æ‡§®)',
      Lahnda: '‡§≤‡§π‡§Ç‡§¶‡§æ (‡§™‡§æ‡§ï‡§ø‡§∏‡•ç‡§§‡§æ‡§®)',
      Javan√™s: '‡§ú‡§æ‡§µ‡§æ‡§®‡•Ä‡§ú (‡§á‡§Ç‡§°‡•ã‡§®‡•á‡§∂‡§ø‡§Ø‡§æ)',
      Turco: '‡§§‡•Å‡§∞‡•ç‡§ï‡•Ä (‡§§‡•Å‡§∞‡•ç‡§ï‡•Ä)'
    },
    erroNicknameObrigatorio: '‡§â‡§™‡§®‡§æ‡§Æ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à‡•§',
    erroNicknameTamanho: '‡§â‡§™‡§®‡§æ‡§Æ 20 ‡§Ö‡§ï‡•ç‡§∑‡§∞‡•ã‡§Ç ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§',
    erroNicknameEspaco: '‡§â‡§™‡§®‡§æ‡§Æ ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§•‡§æ‡§® ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ‡•§',
    erroNicknameEspecial: '‡§â‡§™‡§®‡§æ‡§Æ ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§µ‡§∞‡•ç‡§£ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡§§‡•á‡•§',
    erroIdadeObrigatoria: '‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§™‡§®‡•Ä ‡§â‡§Æ‡•ç‡§∞ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç‡•§'
  },
  ar: {
    header: 'ÿπÿßŸÑŸÖ ÿßŸÑÿØÿ±ÿØÿ¥ÿ©',
    avisoTitle: '‚ö†Ô∏è ÿ•ÿ¥ÿπÿßÿ± ŸÖŸáŸÖ - ŸÑŸÑÿ£ÿπŸÖÿßÿ± 18+ ŸÅŸÇÿ∑ ‚ö†Ô∏è',
    avisoText1: 'Ÿáÿ∞ÿß ÿßŸÑŸÖŸàŸÇÿπ ŸÖÿÆÿµÿµ ŸÑŸÑÿ£ÿ¥ÿÆÿßÿµ ÿßŸÑÿ∞ŸäŸÜ ÿ™ÿ®ŸÑÿ∫ ÿ£ÿπŸÖÿßÿ±ŸáŸÖ 18 ÿ≥ŸÜÿ© ÿ£Ÿà ÿ£ŸÉÿ´ÿ± ŸÅŸÇÿ∑. ÿ®ÿßŸÑÿØÿÆŸàŸÑÿå ÿ£ŸÜÿ™ ÿ™ŸÇÿ± ÿ®ÿ£ŸÜŸÉ ÿ™ÿ≥ÿ™ŸàŸÅŸä ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ÿØŸÜŸâ ŸÑŸÑÿπŸÖÿ± Ÿàÿ™ŸÅŸáŸÖ ÿ£ŸÜ:',
    avisoList: [
      'ŸÜÿ≠ŸÜ ÿ∫Ÿäÿ± ŸÖÿ≥ÿ§ŸàŸÑŸäŸÜ ÿπŸÜ ŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ.',
      'ŸäŸèÿ≠ÿ∏ÿ± ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑŸÖÿ≥Ÿäÿ° ÿ£Ÿà ÿßŸÑÿ•ÿ®ÿßÿ≠Ÿä ÿ£Ÿà ÿßŸÑÿ™ŸÖŸäŸäÿ≤Ÿä ÿ£Ÿà ÿ∫Ÿäÿ± ÿßŸÑŸÇÿßŸÜŸàŸÜŸä.',
      'ÿ≥Ÿäÿ§ÿØŸä ÿπÿØŸÖ ÿßŸÑÿßŸÖÿ™ÿ´ÿßŸÑ ÿ•ŸÑŸâ ÿßŸÑÿ≠ÿ∏ÿ± ÿßŸÑŸÅŸàÿ±Ÿä.'
    ],
    btnAceitar: 'ÿ£ŸàÿßŸÅŸÇ',
    tituloNickname: 'ÿßÿÆÿ™ÿ± ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸàÿßŸÑÿπŸÖÿ±',
    placeholderNickname: 'ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ',
    placeholderIdade: 'ÿßŸÑÿπŸÖÿ±',
    tituloSala: 'ÿßÿÆÿ™ÿ± ÿ∫ÿ±ŸÅÿ©',
    salas: {
      Ingl√™s: 'ÿßŸÑÿ•ŸÜÿ¨ŸÑŸäÿ≤Ÿäÿ© (ÿßŸÑŸàŸÑÿßŸäÿßÿ™ ÿßŸÑŸÖÿ™ÿ≠ÿØÿ©)',
      Mandarim: 'ÿßŸÑŸÖÿßŸÜÿØÿ±ŸäŸÜ (ÿßŸÑÿµŸäŸÜ)',
      Espanhol: 'ÿßŸÑÿ•ÿ≥ÿ®ÿßŸÜŸäÿ© (ÿ•ÿ≥ÿ®ÿßŸÜŸäÿß)',
      Hindi: 'ÿßŸÑŸáŸÜÿØŸäÿ© (ÿßŸÑŸáŸÜÿØ)',
      √Årabe: 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ© (ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©)',
      Franc√™s: 'ÿßŸÑŸÅÿ±ŸÜÿ≥Ÿäÿ© (ŸÅÿ±ŸÜÿ≥ÿß)',
      Russo: 'ÿßŸÑÿ±Ÿàÿ≥Ÿäÿ© (ÿ±Ÿàÿ≥Ÿäÿß)',
      Portugu√™s: 'ÿßŸÑÿ®ÿ±ÿ™ÿ∫ÿßŸÑŸäÿ© (ÿßŸÑÿ®ÿ±ÿßÿ≤ŸäŸÑ)',
      Bengali: 'ÿßŸÑÿ®ŸÜÿ∫ÿßŸÑŸäÿ© (ÿ®ŸÜÿ∫ŸÑÿßÿØŸäÿ¥)',
      Japon√™s: 'ÿßŸÑŸäÿßÿ®ÿßŸÜŸäÿ© (ÿßŸÑŸäÿßÿ®ÿßŸÜ)',
      Lahnda: 'ŸÑÿßŸáŸÜÿØÿß (ÿ®ÿßŸÉÿ≥ÿ™ÿßŸÜ)',
      Javan√™s: 'ÿßŸÑÿ¨ÿßŸàŸäÿ© (ÿ•ŸÜÿØŸàŸÜŸäÿ≥Ÿäÿß)',
      Turco: 'ÿßŸÑÿ™ÿ±ŸÉŸäÿ© (ÿ™ÿ±ŸÉŸäÿß)'
    },
    erroNicknameObrigatorio: 'ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖÿ∑ŸÑŸàÿ®.',
    erroNicknameTamanho: 'Ÿäÿ¨ÿ® ÿ£ŸÑÿß Ÿäÿ≤ŸäÿØ ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿπŸÜ 20 ÿ≠ÿ±ŸÅŸãÿß.',
    erroNicknameEspaco: 'ŸÑÿß ŸäŸÖŸÉŸÜ ÿ£ŸÜ Ÿäÿ≠ÿ™ŸàŸä ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿπŸÑŸâ ŸÖÿ≥ÿßŸÅÿßÿ™.',
    erroNicknameEspecial: 'ŸÑÿß ŸäŸÖŸÉŸÜ ÿ£ŸÜ Ÿäÿ≠ÿ™ŸàŸä ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿπŸÑŸâ ÿ£ÿ≠ÿ±ŸÅ ÿÆÿßÿµÿ©.',
    erroIdadeObrigatoria: 'Ÿäÿ±ÿ¨Ÿâ ÿ•ÿØÿÆÿßŸÑ ÿßŸÑÿπŸÖÿ±.'
  } 
  };

  // Mensagens de erro din√¢micas
  let errorMessages = {};

  // Aplica tradu√ß√µes na p√°gina
  function aplicarIdioma(idioma) {
    document.documentElement.lang = idioma === 'pt' ? 'pt-BR' : idioma;
    const t = texts[idioma] || texts.pt;

    document.querySelector('header').textContent = t.header;
    document.getElementById('avisoTitle').textContent = t.avisoTitle;
    document.getElementById('avisoText1').textContent = t.avisoText1;

    const avisoList = document.getElementById('avisoList');
    avisoList.innerHTML = '';
    t.avisoList.forEach(item => {
      const li = document.createElement('li');
      li.textContent = item;
      avisoList.appendChild(li);
    });

    btnAceitar.textContent = t.btnAceitar;

    document.getElementById('tituloNickname').textContent = t.tituloNickname;
    nicknameInput.placeholder = t.placeholderNickname;
    document.getElementById('idade').placeholder = t.placeholderIdade;
    document.getElementById('tituloSala').textContent = t.tituloSala;

    Object.entries(t.salas).forEach(([key, val]) => {
      const el = document.getElementById('label' + key.replace(/[^a-zA-Z]/g, ''));
      if (el) el.textContent = val;
    });

    errorMessages = {
      obrigatorio: t.erroNicknameObrigatorio,
      tamanho: t.erroNicknameTamanho,
      espaco: t.erroNicknameEspaco,
      especial: t.erroNicknameEspecial,
      idadeObrigatoria: t.erroIdadeObrigatoria
    };
  }

  // Valida√ß√£o do nickname
  function validarNickname(nick) {
    if (!nick) {
      return errorMessages.obrigatorio;
    }
    if (nick.length > 20) {
      return errorMessages.tamanho;
    }
    if (/\s/.test(nick)) {
      return errorMessages.espaco;
    }
    if (/[^a-zA-Z0-9]/.test(nick)) {
      return errorMessages.especial;
    }
    return '';
  }

  // Atualiza mensagem de erro conforme usu√°rio digita
  nicknameInput.addEventListener('input', () => {
    const erro = validarNickname(nicknameInput.value.trim());
    errorNickname.textContent = erro;
  });

  // Ao clicar em aceitar
  btnAceitar.onclick = () => {
    localStorage.setItem('aceitou18', 'true');
    modal.style.display = 'none';
    mainDiv.style.display = 'block';
    // Mostrar seletor fixo e sincronizar idioma
    languageSelectFixed.style.display = 'flex';
  };

  // Ao mudar idioma no modal
  languageSelectModal.addEventListener('change', () => {
    const idioma = languageSelectModal.value;
    localStorage.setItem('lang', idioma);
    aplicarIdioma(idioma);
    // Sincronizar select fixo
    languageSelectFixedSelect.value = idioma;
  });

  // Ao mudar idioma no seletor fixo
  languageSelectFixedSelect.addEventListener('change', () => {
    const idioma = languageSelectFixedSelect.value;
    localStorage.setItem('lang', idioma);
    aplicarIdioma(idioma);
    // Sincronizar select modal, s√≥ se modal existir e estiver vis√≠vel
    if (modal.style.display !== 'none') {
      languageSelectModal.value = idioma;
    }
  });

  // Entrar na sala
  function entrarSala(sala) {
    const nick = nicknameInput.value.trim();
    const idade = document.getElementById('idade').value.trim();

    const erro = validarNickname(nick);
    if (erro) {
      errorNickname.textContent = erro;
      return;
    } else {
      errorNickname.textContent = '';
    }

    if (!idade) {
      alert(errorMessages.idadeObrigatoria);
      return;
    }

    const idioma = localStorage.getItem('lang') || 'pt';

    window.location.href = `chat.html?sala=${encodeURIComponent(sala)}&nick=${encodeURIComponent(nick)}&idade=${idade}&lang=${idioma}`;
  }

  // Atualiza contagem nas salas
  const socket = io();
  socket.on('roomCounts', (counts) => {
    Object.entries(counts).forEach(([room, count]) => {
      const el = document.getElementById(`count-${room}`);
      if (el) el.textContent = count;
    });
  });

window.onload = () => {
  console.log('window.onload disparado');
  const aceitou = localStorage.getItem('aceitou18');
  console.log('Valor aceitou18:', aceitou);

  const idiomaSalvo = localStorage.getItem('lang') || 'pt';
  console.log('Idioma salvo:', idiomaSalvo);

  languageSelectModal.value = idiomaSalvo;
  languageSelectFixedSelect.value = idiomaSalvo;
  aplicarIdioma(idiomaSalvo);

  if (aceitou === 'true') {
    console.log('Usu√°rio j√° aceitou, escondendo modal e mostrando main');
    modal.style.display = 'none';
    mainDiv.style.display = 'block';
    languageSelectFixed.style.display = 'flex';
  } else {
    console.log('Usu√°rio n√£o aceitou ainda, mostrando modal');
    modal.style.display = 'flex';
    mainDiv.style.display = 'none';
    languageSelectFixed.style.display = 'none';
  }
};

</script>

</body>
</html>