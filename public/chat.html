<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Chat</title>
<link rel="stylesheet" href="style.css" />
<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    margin: 0;
    background-color: #e9ecef; /* tom neutro mais suave */
    color: #1d1d1f;
    display: flex;
    flex-direction: column;
    height: 100vh;
  }

  #backBtn {
    background: none;
    border: none;
    font-size: 16px;
    color: #007aff;
    cursor: pointer;
    padding: 12px 16px;
    text-align: left;
  }
  #backBtn:hover {
    text-decoration: underline;
  }

  .chat-container {
    display: flex;
    flex: 1;
    padding: 10px;
    gap: 12px;
  }

  .messages {
    flex: 3;
    background-color: #fdfdfd;
    border-radius: 16px;
    padding: 12px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 8px;
    box-shadow: 0 0 10px rgba(0,0,0,0.05);
  }

  .users {
    flex: 1;
    background-color: #fdfdfd;
    border-radius: 16px;
    padding: 12px;
    box-shadow: 0 0 10px rgba(0,0,0,0.05);
  }

  #statusContainer {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 14px;
  }

  #statusSelect {
    padding: 4px 8px;
    border-radius: 8px;
    border: 1px solid #ccc;
    font-size: 14px;
    background-color: #f5f5f7;
  }

  .status-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    display: inline-block;
  }
  .status-online-dot { background-color: #34c759; }
  .status-busy-dot { background-color: #ff3b30; }

  /* Rodapé do chat alinhado com a área de mensagens */
  #chatInputWrapper {
    display: flex;
    padding: 10px;
    background-color: #fdfdfd;
    border-top: 1px solid #ddd;
    border-radius: 0 0 16px 16px;
    gap: 8px;
  }

  #msgInput {
    flex: 1;
    padding: 10px;
    border-radius: 20px;
    border: 1px solid #ccc;
    font-size: 14px;
    background-color: #f5f5f7;
    outline: none;
  }
  #msgInput:focus {
    border-color: #007aff;
  }

  #sendBtn {
    background-color: #007aff;
    color: white;
    border: none;
    border-radius: 20px;
    padding: 0 16px;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.2s;
  }
  #sendBtn:hover {
    background-color: #005bb5;
  }

  /* Layout geral: mensagens e input em coluna, alinhados */
  .messages-area {
    flex: 3;
    display: flex;
    flex-direction: column;
  }
</style>
</head>
<body>

<!-- Botão Voltar -->
<button id="backBtn">← Voltar</button>

<div class="chat-container">
  <div class="messages-area">
    <div class="messages" id="messages"></div>
    <div id="chatInputWrapper">
      <input id="msgInput" placeholder="Digite sua mensagem..." autocomplete="off" />
      <button id="sendBtn">Enviar</button>
    </div>
  </div>

  <div class="users" id="users">
    <div id="statusContainer">
      <label for="statusSelect" id="statusLabel">Seu Status:</label>
      <span id="statusDot" class="status-dot status-online-dot"></span>
      <select id="statusSelect">
        <option value="online">Online</option>
        <option value="voltoja">Volto Já</option>
        <option value="ocupado">Ocupado</option>
      </select>
    </div>
  </div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script src="client.js"></script>

<script>
  function getQueryParam(param) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(param);
  }

  const texts = {
    pt: {
      backBtn: '← Voltar',
      statusLabel: 'Seu Status:',
      statusOptions: { online: 'Online', voltoja: 'Volto Já', ocupado: 'Ocupado' },
      msgInputPlaceholder: 'Digite sua mensagem...',
      sendBtn: 'Enviar'
    },
    en: {
      backBtn: '← Back',
      statusLabel: 'Your Status:',
      statusOptions: { online: 'Online', voltoja: 'Be Right Back', ocupado: 'Busy' },
      msgInputPlaceholder: 'Type your message...',
      sendBtn: 'Send'
    },
    ar: {
      backBtn: '← رجوع',
      statusLabel: 'حالتك:',
      statusOptions: { online: 'متصل', voltoja: 'سأعود حالًا', ocupado: 'مشغول' },
      msgInputPlaceholder: 'اكتب رسالتك...',
      sendBtn: 'إرسال'
    },
    ru: {
      backBtn: '← Назад',
      statusLabel: 'Ваш статус:',
      statusOptions: { online: 'Онлайн', voltoja: 'Скоро вернусь', ocupado: 'Занят' },
      msgInputPlaceholder: 'Введите сообщение...',
      sendBtn: 'Отправить'
    }
  };

  function aplicarIdiomaChat(lang) {
    const t = texts[lang] || texts.pt;
    document.getElementById('backBtn').textContent = t.backBtn;
    document.getElementById('statusLabel').textContent = t.statusLabel;

    const statusSelect = document.getElementById('statusSelect');
    for (const option of statusSelect.options) {
      const val = option.value;
      if (t.statusOptions[val]) option.textContent = t.statusOptions[val];
    }

    document.getElementById('msgInput').placeholder = t.msgInputPlaceholder;
    document.getElementById('sendBtn').textContent = t.sendBtn;
  }

  window.addEventListener('DOMContentLoaded', () => {
    const lang = getQueryParam('lang') || 'pt';
    aplicarIdiomaChat(lang);
  });
</script>

</body>
</html>